# AIチャットガイド

AIチャットは、執筆のパートナーとして相談したり、作品の登場人物と直接会話したりできる機能です。

## 基本的な使い方

右パネルの「AIチャット」アイコン（吹き出しマーク）をクリックすると、チャットパネルが開きます。

### ロール（役割）の選択

チャットパネルの上部にある「役割」ドロップダウンから、AIの立ち位置を変更できます。

- **助手・編集者**: 執筆全般の相談やアイデア出しに適した標準的な役割です。
- **読者・ファン**: 作品の熱心な読者として振る舞い、純粋な感想を伝えます。
- **執筆者・作者**: プロットの整合性や設定の矛盾など、作者目線の冷静な分析を行います。
- **登場人物（実演）**: メタな発言を控え、徹底的にキャラクターとして振る舞います。

## 登場人物（キャラクター）との対話

設定した登場人物のペルソナを選択することで、キャラクターとしての反応を楽しむことができます。

### キャラクター設定の手順

1.  **キャラクターファイルの作成**: ファイルエクスプローラーで、キャラクター用のマークダウンファイル（例: `織田信長.md`）を作成します。
2.  **メタデータの編集**: 作成したファイルを開き、右パネルの「メタデータ詳細」を開きます。
3.  **チャットの有効化**: メタデータ編集画面で「このキャラクターとチャットする」にチェックを入れます。
4.  **設定の入力**: キャラクターの性格、話し方、背景設定などを入力し、保存します。
    - **アイコンの設定**: 「アイコン」フィールドに `app-asset://assets/icons/character_name.png` のような形式で画像をセットすると、チャット画面にそのアイコンが表示されます。

### チャットでの呼び出し

1.  AIチャットパネルのヘッダーにある「ペルソナ」ドロップダウンを選択します。
2.  「メタデータ」セクションに、先ほど有効化したキャラクターが表示されます。
3.  選択すると、そのキャラクターの性格に基づいた会話が可能になります。

> [!TIP]
> 「役割」を「登場人物（実演）」に設定した状態でキャラクターを選択すると、より没入感のあるロールプレイが可能です。

## 文脈（コンテキスト）の管理

ペルソナや役割を切り替えると、自動的にそれまでの会話の「文脈」が区切られます。

- **表示の維持**: 過去の会話ログはそのままUI上に残り、いつでも読み返せます。
- **文脈のリセット**: 役割等を変更した後の「最初のメッセージ送信時」に、視覚的な区切り線が挿入され、AIには「そこから先の会話」のみが渡されるようになります。これにより、以前のキャラクターの性格が混ざってしまう（文脈汚染）のを防ぎます。

## 日本語小説特有の表現

AIチャットの返信は、小説家の便宜を考えた特別なレンダリングに対応しています。

- **ルビ**: `|漢字《ルビ》` または `漢字《ルビ》` 形式をサポート。
- **傍点**: `《《強調したい文字》》` 形式で、文字の上に点が付きます。
- **マークダウン**: 太字、箇条書き、コードブロックなども通常通り表示されます。

## チャットチャンネル（ファイル単位のチャット）

通常のAIチャットパネルとは異なり、チャットの内容をファイルとして保存し、プロジェクト内で永続的に管理できるのが「チャットチャンネル」機能です。
プロットの相談や、特定のキャラクターとの継続的な会話ログをプロジェクトの一部として残すのに適しています。

### チャットチャンネルの作成方法

以下のいずれかの方法でチャットチャンネルを作成できます。

1.  **直接作成**: ファイル名に `.ch` 拡張子を付けてファイルを作成します（例: `プロット構築.ch`）。
2.  **専用フォルダでの作成**: フォルダ名に「**チャンネル**」という単語を含め（例: `キャラ相談チャンネル`）、その中で新規ファイルを作成すると、自動的にチャットチャンネル形式（`.ch`）として生成されます。

作成が完了すると、ファイルエクスプローラー上で専用の吹き出しアイコンが表示され、クリックすることでチャット UI が開きます。

### チャットチャンネルの特徴

- **履歴の保持**: タブを閉じたりエディターを再起動したりしても、過去のチャットログはファイルに保存されているため維持されます。
- **ファイル管理**: Git を通じて、チャットの履歴も小説の原稿と同じようにバージョン管理が可能です。
- **ペルソナ・ロールの固定**: チャンネルごとにデフォルトのペルソナや役割を設定し、保存しておくことができます。

---
[マニュアルのトップへ戻る](index.md)
[AIアシスタントの活用へ](ai-guide.md)
